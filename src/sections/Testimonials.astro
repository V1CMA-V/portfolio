---
const testimonials = [
  {
    employer: 'Empresa A',
    role: 'Desarrollador Web',
    name: 'Juan Pérez',
    feedback:
      'Trabajar con este desarrollador fue una experiencia increíble. Entregó el proyecto a tiempo y superó nuestras expectativas.',
    image: '/testimonials/juan-perez.jpg',
    color: 'bg-blue-300',
  },
  {
    employer: 'Empresa B',
    role: 'Gerente de Proyecto',
    name: 'María Gómez',
    feedback:
      'Su profesionalismo y atención al detalle fueron excepcionales. Definitivamente lo recomendaría para futuros proyectos.',
    image: '/testimonials/maria-gomez.jpg',
    color: 'bg-green-300',
  },
  {
    employer: 'Empresa C',
    role: 'CTO',
    name: 'Carlos Rodríguez',
    feedback:
      'Un desarrollador talentoso que entiende las necesidades del negocio y las traduce en soluciones efectivas.',
    image: '/testimonials/carlos-rodriguez.jpg',
    color: 'bg-red-300',
  },
]
---

<section id="Testimonials" class="max-w-7xl w-full mx-auto px-4 py-20">
  <!-- Hero -->
  <div class="flex items-center justify-between mb-10">
    <div>
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-bold">Testimonios</h2>

      <p class="text-lg md:text-xl text-muted-text max-w-3xl">
        Lo que dicen mis clientes sobre mi trabajo y profesionalismo.
      </p>
    </div>

    <!-- Navigation buttons -->
    <div class="flex gap-4 items-center">
      <button
        class="swiper-button-prev-custom w-12 h-12 rounded-full border-2 border-primary hover:border-accent hover:bg-accent/10 transition-all duration-300 flex items-center justify-center"
        aria-label="Previous slide"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-primary hover:text-accent transition-colors duration-300"
        >
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <button
        class="swiper-button-next-custom w-12 h-12 rounded-full border-2 border-primary hover:border-accent hover:bg-accent/10 transition-all duration-300 flex items-center justify-center"
        aria-label="Next slide"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-primary hover:text-accent transition-colors duration-300"
        >
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>
  </div>

  <div class="swiper mySwiper">
    <div class="swiper-wrapper">
      {
        testimonials.map((testimonial) => (
          <div
            class={`swiper-slide ${testimonial.color} p-8 md:p-12 rounded-2xl flex flex-col md:flex-row gap-6 md:gap-12 items-center md:items-stretch`}
          >
            <div class="flex-1 flex flex-col justify-between">
              <div>
                <h5 class="text-lg md:text-xl font-semibold text-gray-800 mb-6">
                  {testimonial.employer}
                </h5>

                <p class="text-2xl md:text-3xl lg:text-4xl font-medium text-gray-900 leading-relaxed mb-8">
                  "{testimonial.feedback}"
                </p>
              </div>

              <div class="mt-auto">
                <p class="text-base md:text-lg font-semibold text-gray-900">
                  {testimonial.name}
                </p>
                <p class="text-sm md:text-base text-gray-600">
                  {testimonial.role}
                </p>
              </div>
            </div>

            <div class="w-full md:w-1/3 flex items-center justify-center">
              {testimonial.image && (
                <img
                  src={testimonial.image}
                  alt={`Foto de ${testimonial.name}`}
                  class="w-48 h-48 md:w-full md:h-auto object-cover rounded-xl"
                />
              )}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  .swiper {
    width: 100%;
    min-height: 400px;
    position: relative;
  }

  .swiper-slide {
    height: auto;
    display: flex;
  }

  @media (max-width: 768px) {
    .swiper {
      min-height: 500px;
    }
  }

  .swiper-button-prev-custom,
  .swiper-button-next-custom {
    cursor: pointer;
  }

  .swiper-button-prev-custom:hover svg,
  .swiper-button-next-custom:hover svg {
    color: var(--color-accent);
  }
</style>

<script>
  import Swiper from 'swiper'
  import { Navigation } from 'swiper/modules'
  // import Swiper and modules styles
  import 'swiper/css'
  import 'swiper/css/navigation'

  function initSwiper() {
    // init Swiper:
    const swiper = new Swiper('.mySwiper', {
      // configure Swiper to use modules
      modules: [Navigation],
      loop: true,
      navigation: {
        nextEl: '.swiper-button-next-custom',
        prevEl: '.swiper-button-prev-custom',
      },
      slidesPerView: 1,
      spaceBetween: 30,
    })
  }

  // Initialize on page load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSwiper)
  } else {
    initSwiper()
  }

  // Re-initialize on Astro page transitions
  document.addEventListener('astro:page-load', initSwiper)
</script>
